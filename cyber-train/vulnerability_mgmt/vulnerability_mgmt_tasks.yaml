vuln_policy_definition_task:
  description: >
    Define enterprise vulnerability management policy including scan cadence,
    SLA timelines, and risk-based prioritization. Use Compliance Framework Tool
    to align with PCI DSS, NIST CSF, and ISO 27001.
  expected_output: >
    A JSON object with VM policy definition.
    Example: {"scan_cadence":"weekly","sla":{"critical":"7 days","high":"30 days"}}
  agent: vuln_strategist
  output_file: output/vuln_policy.json

attack_surface_discovery_task:
  description: >
    Discover internet-facing assets and shadow IT. Use Attack Surface Discovery Tool
    to map domains, IPs, cloud resources, and exposed services.
  expected_output: >
    A JSON object with discovered assets and risk findings.
    Example: {"discovered_assets":["api.legacy.com","vpn.example.com"],"risks":["Open RDP","Expired cert"]}
  agent: vuln_engineer
  output_file: output/attack_surface.json

vuln_scanning_task:
  description: >
    Perform vulnerability scans on IT, cloud, and container environments using Vulnerability Scanner Tool
    and Container Security Tool. Correlate with Threat Intelligence Feeds Tool.
  expected_output: >
    A JSON object with scan results.
    Example: {"assets_scanned":450,"vulnerabilities":[{"cve":"CVE-2025-1234","severity":"Critical","exploit":"Yes"}]}
  agent: vuln_engineer
  output_file: output/vuln_scans.json

dependency_vulnerability_task:
  description: >
    Perform SBOM-based dependency scanning for open-source and third-party libraries.
    Use SBOM Scanner Tool to detect known CVEs in code repositories and deployed applications.
  expected_output: >
    A JSON object with dependency vulnerabilities.
    Example: {"sbom_scanned":"projectX","dependencies_vulnerable":["log4j:2.14.1"],"severity":"Critical"}
  agent: vuln_engineer
  output_file: output/dependency_vulns.json

risk_based_prioritization_task:
  description: >
    Prioritize vulnerabilities using Risk Scoring Tool. Combine CVSS scores, threat intel,
    business impact, and exploitability into a single risk score.
  expected_output: >
    A JSON object with prioritized vulnerabilities.
    Example: {"prioritized":[{"cve":"CVE-2025-1234","risk_score":9.8,"asset":"prod-db"}]}
  agent: vuln_strategist
  context: [vuln_scanning_task, dependency_vulnerability_task, attack_surface_discovery_task]
  output_file: output/vuln_prioritization.json

exploit_simulation_task:
  description: >
    Validate exploitability using Exploit Simulation Tool. Simulate attacks against
    selected critical vulnerabilities to confirm risk levels.
  expected_output: >
    A JSON object with exploit simulation results.
    Example: {"tested_vulns":["CVE-2025-1234"],"exploitable":["CVE-2025-1234"],"non_exploitable":["CVE-2025-5678"]}
  agent: vuln_engineer
  context: [risk_based_prioritization_task]
  output_file: output/exploit_simulation.json

patch_management_task:
  description: >
    Deploy and validate patches using Patch Management Tool and Container Security Tool.
    Re-scan systems post-remediation to confirm fixes.
  expected_output: >
    A JSON object with patch deployment results.
    Example: {"patches_applied":120,"success_rate":97,"failed_assets":["server42"]}
  agent: vuln_engineer
  context: [risk_based_prioritization_task, exploit_simulation_task]
  output_file: output/patch_management.json

config_drift_detection_task:
  description: >
    Detect configuration drift against security benchmarks (CIS, NIST). Use Config Drift Detector
    to identify deviations in cloud and on-prem environments.
  expected_output: >
    A JSON object with drift findings.
    Example: {"assets_checked":200,"drift_detected":["serverA","cloud_vm1"],"benchmarks_failed":["CIS-Linux-2.1"]}
  agent: vuln_engineer
  output_file: output/config_drift.json

zero_day_monitoring_task:
  description: >
    Monitor for zero-day vulnerabilities via Threat Intelligence Feeds Tool.
    Flag assets potentially exposed and recommend compensating controls.
  expected_output: >
    A JSON object with zero-day alerts.
    Example: {"zero_day":"CVE-2025-4321","affected_assets":["app1"],"mitigation":"apply WAF rule"}
  agent: vuln_engineer
  output_file: output/zero_day_alerts.json

remediation_orchestration_task:
  description: >
    Orchestrate remediation tasks into ITSM/SOAR platforms (ServiceNow, Jira).
    Use ITSM Integration Tool to open tickets, assign owners, and track progress.
  expected_output: >
    A JSON object with ticketing and remediation orchestration details.
    Example: {"tickets_created":[{"id":"SNOW123","cve":"CVE-2025-1234","owner":"teamA"}]}
  agent: vuln_engineer
  context: [patch_management_task, config_drift_detection_task]
  output_file: output/remediation_orchestration.json

bug_bounty_integration_task:
  description: >
    Integrate bug bounty findings from Bug Bounty Integration Tool.
    Validate reported issues, correlate with internal vulnerability data,
    and assign remediation owners.
  expected_output: >
    A JSON object with bounty findings and mapping.
    Example: {"bounty_findings":[{"id":"BUG123","vuln":"XSS","status":"validated"}]}
  agent: vuln_auditor
  output_file: output/bug_bounty.json

vuln_remediation_tracking_task:
  description: >
    Track remediation status against SLA policy using SLA Tracker Tool.
    Escalate overdue items to management.
  expected_output: >
    A JSON object with SLA compliance stats.
    Example: {"sla_compliance":92,"overdue":[{"cve":"CVE-2025-5678","days_overdue":14}]}
  agent: vuln_auditor
  context: [risk_based_prioritization_task, remediation_orchestration_task]
  output_file: output/remediation_tracking.json

vuln_metrics_reporting_task:
  description: >
    Generate executive metrics and dashboards using Reporting Dashboard Tool.
    Include MTTR, vuln recurrence, patch adoption, SLA adherence, and exposure trends.
  expected_output: >
    A JSON object with vulnerability management KPIs.
    Example: {"mttr_days":14,"sla_adherence":92,"recurrence_rate":3,"trend":"improving"}
  agent: vuln_auditor
  context: [vuln_remediation_tracking_task, bug_bounty_integration_task]
  output_file: output/vuln_metrics.json

vuln_audit_task:
  description: >
    Perform quarterly audit of the vulnerability management program. Use Audit Checklist Tool
    and Compliance Mapping Tool to validate coverage, SLA adherence, and maturity metrics.
  expected_output: >
    A JSON object with audit score and findings.
    Example: {"score":88,"findings":["Critical vulns exceeded SLA","Cloud drift not addressed"],"remediations":["Patch criticals faster","Harden cloud config"]}
  agent: vuln_auditor
  context: [vuln_metrics_reporting_task, vuln_remediation_tracking_task]
  output_file: output/vuln_audit.json
